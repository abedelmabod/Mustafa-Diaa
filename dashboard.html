<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª - Ù…ØµØ·ÙÙ‰ Ø¶ÙŠØ§Ø¡</title>
  <link rel="stylesheet" href="logstyle.css">
</head>
<body>
  <div class="dashboard-container">
    <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="user-name"></span></h1>
    <h3>Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©: <span id="user-year"></span></h3>

    <div id="courses-container"></div>

    <!-- Ø²Ø± Ù„Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ Ø¬Ø¯ÙŠØ¯ ÙÙ‚Ø· Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ -->
    <button id="add-video-btn" style="display:none" onclick="window.location.href='add-video.html'">Ø¥Ø¶Ø§ÙØ© ÙÙŠØ¯ÙŠÙˆ</button>

    <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ -->
    <button id="logout-btn" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  </div>

  <script>
    const username = localStorage.getItem("user");
    const year = localStorage.getItem("year");

    document.getElementById("user-name").innerText = username;
    document.getElementById("user-year").innerText = year;

    // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ø§Ù„Ø£Ø¯Ù…Ù†
    if (year === "admin") {
      document.getElementById("add-video-btn").style.display = "block";
    }

    const container = document.getElementById("courses-container");

    const renderCourses = (courseList, yearLabel) => {
      const yearHeader = document.createElement("h2");
      yearHeader.innerText = `ğŸ“˜ ÙƒÙˆØ±Ø³Ø§Øª Ø³Ù†Ø© ${yearLabel}`;
      container.appendChild(yearHeader);

      courseList.forEach((course, courseIndex) => {
        const courseBox = document.createElement("div");
        courseBox.className = "course-box";

        const title = document.createElement("h3");
        title.innerText = `ğŸ“š ${course.course}`;
        courseBox.appendChild(title);

        course.videos.forEach((video, videoIndex) => {
          const videoTitle = document.createElement("p");
          videoTitle.innerText = video.title;

          const iframe = document.createElement("iframe");
          iframe.src = video.url;
          iframe.width = "100%";
          iframe.height = "360";
          iframe.allow = "autoplay; fullscreen";
          iframe.setAttribute("frameborder", "0");

          // Ø²Ø± Ø§Ù„Ø­Ø°Ù Ù„Ù„ÙÙŠØ¯ÙŠÙˆ ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ùˆ Ø§Ù„Ø£Ø¯Ù…Ù†
          if (year === "admin") {
            const deleteButton = document.createElement("button");
            deleteButton.innerText = "Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ";
            deleteButton.style.backgroundColor = "red";
            deleteButton.style.color = "white";
            deleteButton.style.border = "none";
            deleteButton.style.padding = "5px 10px";
            deleteButton.style.cursor = "pointer";
            deleteButton.onclick = () => {
              deleteVideo(yearLabel, courseIndex, videoIndex);
            };

            courseBox.appendChild(deleteButton);
          }

          courseBox.appendChild(videoTitle);
          courseBox.appendChild(iframe);
        });

        container.appendChild(courseBox);
      });
    };

    // Ø¯Ø§Ù„Ø© Ù„Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    const deleteVideo = (yearLabel, courseIndex, videoIndex) => {
      const videosByYear = JSON.parse(localStorage.getItem("videosByYear")) || {};

      // Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
      videosByYear[yearLabel][courseIndex].videos.splice(videoIndex, 1);

      // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙØ§Ø±ØºØ© Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°ÙØŒ ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„ÙƒÙˆØ±Ø³
      if (videosByYear[yearLabel][courseIndex].videos.length === 0) {
        videosByYear[yearLabel].splice(courseIndex, 1);
      }

      // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¹Ø¯Ù„Ø© ÙÙŠ Local Storage
      localStorage.setItem("videosByYear", JSON.stringify(videosByYear));

      alert("âœ… ØªÙ… Ø­Ø°Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ù†Ø¬Ø§Ø­!");
      location.reload();  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    };

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ù† localStorage
    const videosByYear = JSON.parse(localStorage.getItem("videosByYear")) || {};

    if (year === "admin") {
      for (let y in videosByYear) {
        renderCourses(videosByYear[y], y);
      }
    } else {
      renderCourses(videosByYear[year], year);
    }

    // Ø¯Ø§Ù„Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    function logout() {
      // Ø¥Ø²Ø§Ù„Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† localStorage
      localStorage.removeItem("user");
      localStorage.removeItem("year");

      // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      window.location.href = "login.html";
    }
  </script>
</body>
</html>
                 